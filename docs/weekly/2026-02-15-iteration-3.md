# Forge Unattended Iteration - 2026-02-15 (v2.6.3)

## 1) 本轮改动摘要

- 完成 Bug Hunt：补齐 `path` 白名单校验并新增跨项目状态隔离回归。
- 完成安全加固：增强 `repoName` / `testCommand` / `packages` / `path` 注入面校验。
- 完成性能优化：新增 `runs(feature_id, status)` 复合索引，减少相关状态查询扫描。
- 完成工程质量：补充回归测试到 +4（相较上轮新增 4 条）、保持接口不变且版本号递增。
- 已将版本提升至 `v2.6.3`。

## 2) 风险清单

### P0

- 跨项目查询串扰导致状态/运行数据混淆。
  - 状态：已修复（`forge_status` 始终按 `project_id` 限定；新增回归测试验证）。

### P1

- 输入白名单覆盖空洞：`repoName`、`path`、`testCommand`。
  - 状态：已修复（新增 `PATH_PATTERN` 与字符级拒绝规则）。

### P2

- 热路径 `forge_status` 在高基线运行数下扫描成本偏高。
  - 状态：已优化（新增 `idx_runs_feature_id_status`，并验证 QPS）。

## 3) 性能对比（Before vs After）

基准方式：`node /tmp/forge-bench.mjs`，同构造数据集（feature=120），同等执行环境。

- `forge_status`
  - Before: `p50 0.001ms`, `p95 0.029ms`, `QPS 70736.6`
  - After: `p50 0.001ms`, `p95 0.033ms`, `QPS 71557.1`
- `forge_run`
  - Before: `p50 0.001ms`, `p95 0.151ms`, `QPS 16065.2`
  - After: `p50 0.001ms`, `p95 0.174ms`, `QPS 15038.7`
- `forge_implement`
  - Before: `p50 0.103ms`, `p95 0.404ms`, `QPS 7557.3`
  - After: `p50 0.113ms`, `p95 0.449ms`, `QPS 6409.3`

## 4) 测试结果

- 命令：`npm test -- --runInBand`
- 通过：`22`
- 失败：`0`

## 5) 影响文件

- `index.js`
- `__tests__/index.test.js`
- `package.json`
- `openclaw.plugin.json`
- `CHANGELOG.md`
- `docs/weekly/2026-02-15-iteration-3.md`
